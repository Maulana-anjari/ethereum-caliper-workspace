# =====================================================
#          TEMPLATE KONFIGURASI EKSPERIMEN
# set -a && source .env && set +a && ./run_pipeline.sh
# =====================================================

# --- Pengaturan Jaringan Blockchain ---
NETWORK_ID=52619
COMPOSE_PROJECT_NAME=blockchain_sut
# Endpoint RPC untuk salah satu node Anda
# Catatan: Pada konfigurasi PoA default, Signer-UGM memetakan HTTP di 8545 dan WebSocket di 8546. 
# Nonsigner 1 di port ws: 8546
# Gunakan HTTP di 8557 agar skrip deploy tidak salah menggunakan WS ke port HTTP. http://77.237.244.170:8545
NODE_URL="ws://77.237.244.170:32770"
BLOCKCHAIN_NODE_URL="ws://77.237.244.170:32770"
CONSENSUS="PoS"
TOPOLOGY="3V-1NV"
# Tuning beban jaringan
# Setelah monitoring stabil, tingkatkan laju uji 
# (mis. naikan transactionLoad atau tambah worker) sambil awasi latensi; 
# bila tetap lambat, perpendek BLOCK_TIME atau naikkan BLOCK_GAS_LIMIT di jaringan PoA.
BLOCK_TIME=12
BLOCK_GAS_LIMIT=8000000
BLOCK_GAS_PRICE=10000000000
TX_CONFIRM_BLOCKS=2

# --- Pengaturan Kontrak Benchmark ---
# Definisikan semua kontrak yang akan diuji di sini
CONTRACT_NAME_MINT="MintCertificate"
CONTRACT_DEFINITION_PATH_MINT="contracts/abi/MintCertificate.json"

CONTRACT_NAME_CPU="CpuStressTest"
CONTRACT_DEFINITION_PATH_CPU="contracts/abi/CpuStressTest.json"

# --- Pengaturan Eksekusi Benchmark ---
# Skenario inti yang akan dijalankan, dipisahkan dengan koma tanpa spasi
# CORE_SCENARIOS="throughput-fixed-load,throughput-step,mixed-workload,worker-scale,certificate-lifecycle,stability-soak,fault-injection"
CORE_SCENARIOS="throughput-fixed-load"
# Berapa kali setiap pengujian inti akan diulang (untuk mendapatkan rata-rata)
NUM_TRIALS=1
# Argumen tambahan untuk Caliper, misal: --caliper-flow-only-test
CALIPER_RUN_ARGS="--caliper-report-format html"

# --- Pengaturan Database (untuk log-to-db.js) ---
GEMINI_API_KEY="AIzaSyBf2OtpHwSnslK2xFgt0XR5ac2fmGb5GYo"
# DATABASE
DATABASE_URL="postgresql://maul:passMaul1234@localhost:5432/postgreskripsi?schema=public"
POSTGRES_USER=maul
POSTGRES_PASSWORD=passMaul1234
POSTGRES_DB=skripsi
POSTGRES_HOST_PORT=5432

CONTRACT_GAS_MINT_benchmarkMint=300000
CONTRACT_GAS_READ_certificateNumbers=100000
CONTRACT_GAS_CPU_calculate=1200000

LAM_MINT_TPS=8
LAM_READ_TPS=60
LAM_BURN_TPS=5
LAM_BURN_TOKENS_PER_WORKER=10

# Fault injection hook configuration (disabled by default)
FAULT_INJECT_ENABLED=true
# Default contoh jalur docker-compose lokal; ganti sesuai validator target
FAULT_INJECT_COMPOSE_FILE="/home/maul/poa/signer/UI/docker-compose.yml"
FAULT_INJECT_SERVICE=geth
FAULT_INJECT_DELAY=120
FAULT_INJECT_LOG_FILE="/tmp/fault-injection.log"
FAULT_INJECT_SSH_TARGET="maul@77.237.244.170"
FAULT_INJECT_ENV_FILES="/home/maul/poa/global.env /home/maul/poa/signer/UI/node.env"

# Monitoring
PROMETHEUS_PUSH_URL=http://localhost:9091
PROMETHEUS_HOST_PORT=9090
PUSHGATEWAY_HOST_PORT=9091
GRAFANA_HOST_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin123
DOCKER_EXPORTER_HOST_PORT=9417

OPTIMAL_TPS_OVERRIDE=8 # Override TPS optimal dari eksperimen sebelumnya

ACCOUNTS_JSON='[{"address":"0x8943545177806ED17B9F23F0a21ee5948eCaa776","privateKey":"0xbcdf20249abf0ed6d944c0288fad489e33f66b3960d9e6229c1cd214ed3bbe31"},{"address":"0xE25583099BA105D9ec0A67f5Ae86D90e50036425","privateKey":"0x39725efee3fb28614de3bacaffe4cc4bd8c436257e2c8bb887c4b5c4be45e76d"},{"address":"0x614561D2d143621E126e87831AEF287678B442b8","privateKey":"0x53321db7c1e331d93a11a41d16f004d7ff63972ec8ec7c25db329728ceeb1710"},{"address":"0xf93Ee4Cf8c6c40b329b0c0626F28333c132CF241","privateKey":"0xab63b23eb7941c1251757e24b3d2350d2bc05c3c388d06f8fe6feafefb1e8c70"},{"address":"0x802dCbE1B1A97554B4F50DB5119E37E8e7336417","privateKey":"0x5d2344259f42259f82d2c140aa66102ba89b57b4883ee441a8b312622bd42491"},{"address":"0xAe95d8DA9244C37CaC0a3e16BA966a8e852Bb6D6","privateKey":"0x27515f805127bebad2fb9b183508bdacb8c763da16f54e0678b16e8f28ef3fff"},{"address":"0x2c57d1CFC6d5f8E4182a56b4cf75421472eBAEa4","privateKey":"0x7ff1a4c1d57e5e784d327c4c7651e952350bc271f156afb3d00d20f5ef924856"},{"address":"0x741bFE4802cE1C4b5b00F9Df2F5f179A1C89171A","privateKey":"0x3a91003acaf4c21b3953d94fa4a6db694fa69e5242b2e37be05dd82761058899"},{"address":"0xc3913d4D8bAb4914328651C2EAE817C8b78E1f4c","privateKey":"0xbb1d0f125b4fb2bb173c318cdead45468474ca71474e2247776b2b4c0fa2d3f5"},{"address":"0x65D08a056c17Ae13370565B04cF77D2AfA1cB9FA","privateKey":"0x850643a0224065ecce3882673c21f56bcf6eef86274cc21cadff15930b59fc8c"},{"address":"0x3e95dFbBaF6B348396E6674C7871546dCC568e56","privateKey":"0x94eb3102993b41ec55c241060f47daa0f6372e2e3ad7e91612ae36c364042e44"},{"address":"0x5918b2e647464d4743601a865753e64C8059Dc4F","privateKey":"0xdaf15504c22a352648a71ef2926334fe040ac1d5005019e09f6c979808024dc7"},{"address":"0x589A698b7b7dA0Bec545177D3963A2741105C7C9","privateKey":"0xeaba42282ad33c8ef2524f07277c03a776d98ae19f581990ce75becb7cfa1c23"},{"address":"0x4d1CB4eB7969f8806E2CaAc0cbbB71f88C8ec413","privateKey":"0x3fd98b5187bf6526734efaa644ffbb4e3670d66f5d0268ce0323ec09124bff61"},{"address":"0xF5504cE2BcC52614F121aff9b93b2001d92715CA","privateKey":"0x5288e2f440c7f0cb61a9be8afdeb4295f786383f96f5e35eb0c94ef103996b64"},{"address":"0xF61E98E7D47aB884C244E39E031978E33162ff4b","privateKey":"0xf296c7802555da2a5a662be70e078cbd38b44f96f8615ae529da41122ce8db05"},{"address":"0xf1424826861ffbbD25405F5145B5E50d0F1bFc90","privateKey":"0xbf3beef3bd999ba9f2451e06936f0423cd62b815c9233dd3bc90f7e02a1e8673"},{"address":"0xfDCe42116f541fc8f7b0776e2B30832bD5621C85","privateKey":"0x6ecadc396415970e91293726c3f5775225440ea0844ae5616135fd10d66b5954"},{"address":"0xD9211042f35968820A3407ac3d80C725f8F75c14","privateKey":"0xa492823c3e193d6c595f37a18e3c06650cf4c74558cc818b16130b293716106f"},{"address":"0xD8F3183DEF51A987222D845be228e0Bbb932C222","privateKey":"0xc5114526e042343c6d1899cad05e1c00ba588314de9b96929914ee0df18d46b2"},{"address":"0xafF0CA253b97e54440965855cec0A8a2E2399896","privateKey":"0x04b9f63ecf84210c5366c66d68fa1f5da1fa4f634fad6dfc86178e4d79ff9e59"}]'

# Contoh konfigurasi tambahan untuk skrip extract-kurtosis-accounts
KURTOSIS_LOG_PATH=blockchain-pos-geth/kurtosis-running.log
KURTOSIS_ACCOUNT_LIMIT=3
